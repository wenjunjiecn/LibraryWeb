{"remainingRequest":"D:\\library\\libraryVueWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\library\\libraryVueWeb\\src\\views\\announcement\\components\\ArticleDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\library\\libraryVueWeb\\src\\views\\announcement\\components\\ArticleDetail.vue","mtime":1594040570010},{"path":"D:\\library\\libraryVueWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575272867830},{"path":"D:\\library\\libraryVueWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1575272866404},{"path":"D:\\library\\libraryVueWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575272867830},{"path":"D:\\library\\libraryVueWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":1575272905142}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport Tinymce from '@/components/Tinymce'\r\nimport Upload from '@/components/Upload/SingleImage3'\r\nimport MDinput from '@/components/MDinput'\r\nimport Sticky from '@/components/Sticky' // 粘性header组件\r\nimport { validURL } from '@/utils/validate'\r\nimport { fetchArticle } from '@/api/article'\r\nimport store from '../../../store/modules/user.js'\r\nimport Warning from './Warning'\r\nimport { CommentDropdown, PlatformDropdown, SourceUrlDropdown } from './Dropdown'\r\nimport axios from 'axios';\r\n\r\nconst defaultForm = {\r\n  status: 'draft',\r\n  title: '', // 文章题目\r\n  content: '', // 文章内容\r\n  content_short: '', // 文章摘要\r\n  display_time: undefined, // 前台展示时间\r\n  id: undefined,\r\n  importance: 0\r\n}\r\n\r\nexport default {\r\n  name: 'ArticleDetail',\r\n  components: { Tinymce, MDinput, Upload, Sticky, Warning, CommentDropdown, PlatformDropdown, SourceUrlDropdown },\r\n  props: {\r\n    isEdit: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data() {\r\n    return{\r\n      postForm:{\r\n        status: 'draft',\r\n        title: '', // 文章题目\r\n        content: '', // 文章内容\r\n        content_short: '', // 文章摘要\r\n        display_time: undefined, // 前台展示时间\r\n        importance: 0,\r\n        author:''\r\n      },\r\n      rules: {\r\n        title: [\n            { required: true, message: '请输入标题', trigger: 'blur' },\n            { min: 2, max: 30, message: '长度在 2 到 30 个字符（包括汉字）', trigger: 'blur' }\n          ],\r\n        content: [\n           // { max: 500, message: '最多不超过500个字符', trigger: 'blur' }\r\n            {required: true, message: '请输入发布内容', trigger: 'blur' },\r\n            { min: 2, max: 2000, message: '生成的html长度在 2 到 2000 个字符', trigger: 'blur' }\n        ],\r\n        content_short: [\n            { required: true, message: '请输入概要', trigger: 'blur' },\r\n            { min: 2, max: 250, message: '长度在 2 到 250 个字符（包括汉字）', trigger: 'blur' }\n          ],\r\n        author: [\r\n            { required: true, message: '请输入作者', trigger: 'blur' },\r\n            { min: 1, max: 12, message: '长度在 1 到 12 个字符（包括汉字）', trigger: 'blur' }\r\n          ],\r\n        display_time: [\r\n            { required: true, message: '请选择时间', trigger: 'blur' },\r\n\r\n          ],\r\n        important: [\r\n\r\n        ],\r\n      },\r\n    }\r\n\r\n  },\r\n\r\n  methods: {\r\n\r\n    submitForm() {\r\n      var vm=this\r\n      console.log(this.postForm)\r\n      this.$refs.postForm.validate(valid => {\r\n        if (valid) {\r\n          self=this\r\n          const path = 'http://127.0.0.1:5000/api/announcement/publish';\r\n                axios.post(path, {\r\n                   title:vm.postForm.title,\r\n                   content:vm.postForm.content,\r\n                   content_short:vm.postForm.content_short,\r\n                   time:this.moment(vm.postForm.display_time).format(\"YYYY-MM-DD HH:mm:ss\"),\r\n                   importance:vm.postForm.importance,\r\n                   author:vm.postForm.author,\r\n                   adminID:store.state.name\r\n                  })\r\n\r\n                  .then(function (response) {\r\n                  //  this.$refs[temp].resetFields();\r\n                   \r\n                      vm.$notify({\r\n                        title: '成功',\r\n                        message: '发布文章成功',\r\n                        type: 'success',\r\n                        duration: 2000,\r\n\r\n                      })\r\n                      vm.postForm.status = 'published'\r\n                      self.loading = false\r\n                  })\r\n                  .catch(function (error) {\r\n                     vm.$message({\r\n                        type: 'info',\r\n                        message: '发布失败'\r\n                      });\r\n\r\n                })\r\n             this.loading = false\r\n        } else {\r\n          vm.$message({\r\n                  type: 'info',\r\n                  message: '发布失败，请检查输入是否完整'\r\n           });\r\n        }\r\n      })\r\n    },\n\r\n\r\n  }\r\n}\r\n",null]}