{"remainingRequest":"D:\\library\\libraryVueWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\library\\libraryVueWeb\\src\\views\\announcement\\components\\Timeline.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\library\\libraryVueWeb\\src\\views\\announcement\\components\\Timeline.vue","mtime":1594168288569},{"path":"D:\\library\\libraryVueWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575272867830},{"path":"D:\\library\\libraryVueWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1575272866404},{"path":"D:\\library\\libraryVueWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1575272867830},{"path":"D:\\library\\libraryVueWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":1575272905142}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport axios from 'axios';\nimport gettoken from '../../../../src/store/modules/user.js'\nimport permission from '@/directive/permission/index.js'\nexport default {\n  directives: { permission },\n  data() {\n    return {\n      dialogVisible: false,\n      initSuccess: false,\n      timeline: [],\n      tag: true,\n      totalCount: 1,\n      detailList: {\n        title: '初始化',\n        author: '',\n        content_short: '',\n        content: '',\n        time: '',\n        important: '',\n\n      },\n\n    }\n  },\n  created() {\n\n    this.getList()\n  },\n  methods: {\n    getList() {\n      var vm = this\n      let mytoken = gettoken.state.token\n      const path = 'http://127.0.0.1:5000/api/announcement';\n      axios.get(path, {\n          params: {\n            token: mytoken\n          }\n        })\n        .then((res) => {\n          vm.timeline = res.data;\n          // vm.totalCount=Object.keys(this.list).length;\n          vm.initSuccess = true\n          vm.$message({\n            message: '数据加载完成',\n            type: 'success'\n          });\n        })\n        .catch((error) => {\n\n          vm.$message({\n            type: 'info',\n            message: '获取数据失败，请检查网络' + error\n          });\n\n        });\n\n\n    },\n    handleDelete(row) {\n      var vm = this\n      this.$confirm('您即将删除一条公告，确定吗', '提示', {\n        confirmButtonText: '确定删除',\n        cancelButtonText: '点错了',\n        type: 'warning'\n      }).then(() => {\n        axios.post('http://127.0.0.1:5000/api/deleteann', {\n            annID: row.mesID\n          })\n\n          .then(function(response) {\n            //  this.$refs[temp].resetFields();\n            vm.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n          })\n          .catch(function(error) {\n            vm.$message({\n              type: 'info',\n              message: error\n            });\n          })\n\n        setTimeout(() => {\n          this.getList()\n        }, 1.5 * 1000)\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n\n    detail(item) {\n      this.detailList.title = item.title;\n      this.detailList.author = item.author;\n      this.detailList.content_short = item.content_short;\n      this.detailList.content = item.content;\n      this.detailList.time = item.time;\n      this.detailList.important = item.important;\n\n      this.dialogVisible = true\n    },\n    tableRowClassName({\n      row,\n      rowIndex\n    }) {\n      if (row.important == 1) {\n        return 'important_1';\n      } else if (row.important == 2) {\n        return 'important_2';\n      } else if (row.important == 3) {\n        return 'important_3';\n      }\n      return '';\n    }\n  }\n}\n",null]}